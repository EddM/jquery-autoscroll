// Generated by CoffeeScript 1.3.1
(function() {

  $.fn.autoScroll = function(options) {
    var _this = this;
    this.settings = $.extend({
      'offset': 50,
      'url': '',
      'loading': function() {
        return null;
      },
      'completed': function() {
        return null;
      },
      'page': 1
    }, options);
    this.currentPage = this.settings.page;
    this.paging = false;
    this.lastScrollPos = 0;
    this.scrollingDown = function() {
      return $(_this).scrollTop() > _this.lastScrollPos;
    };
    return $(this).scroll(function() {
      var scrollingDown;
      scrollingDown = _this.scrollingDown();
      _this.lastScrollPos = $(_this).scrollTop();
      if (!_this.paging && scrollingDown && $(_this).scrollTop() >= ($(document).height() - ($(_this).height() + _this.settings.offset))) {
        _this.paging = true;
        _this.settings.loading();
        return $.ajax(_this.settings.url, {
          dataType: 'js',
          data: {
            page: _this.currentPage + 1
          },
          success: function() {
            return _this.currentPage += 1;
          },
          complete: function() {
            _this.paging = false;
            return _this.settings.completed();
          }
        });
      }
    });
  };

}).call(this);
